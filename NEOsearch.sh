#!/bin/bash

# Welcome to NEO's file search utility. I am still working on this little side project but figured its basically working now so I may as well share it. 

# This little script (in its current state) will search the contents of all files contained in the target folder and all subfolders for words contained in keywords.txt. Files that match will output the results to the working directory in a file called NEOsearchKEYWORDS.txt

# Version: 0.1
# Date: 17/06/2020
# Functionality soon to be added:
# - Optional subfolder searching
# - Evaluate directory and file permissions
# - Disable keyword search
# - Auto crack PW hashes upon detection

##############UNDER DEVELOPMENT######################
#read -p "Do you want to search all file types in the target directory? Enter Y or N: " allfiletypes
#if [ $allfiletypes == N -o $allfiletypes == "n" ]; then
# read -p "What file types would you like to target? Eg: *.txt,*.html,*.php " scantargets
#fi
#read -p "Would you like to search all subfolders? Enter Y or N: " recursive
#read -p "Would you like to enable folder write test? Enter Y or N: " permissionscheck
#read -p "Would you like to enable key word search? (see wordlists.txt) Enter Y or N: " keywordsearch
##############UNDER DEVELOPMENT######################

allfiletypes=n
scantargets=*.txt,*.php,*.sh
recursive=n
permissionscheck=n
keywordsearch=y
currentdir=$(pwd)
keywordsfile="keywords.txt"

read -p "What is the target directory to scan? Eg: '"/root/Desktop/"': " targetdir

##READ THE KEYWORDS FILE AND POPULATE THE GREP COMMAND SYNTAX
for line in $(cat $keywordsfile);
do
targetgrep=""$targetgrep" -e "$line""
done
##READ THE KEYWORDS FILE AND POPULATE THE GREP COMMAND SYNTAX


for folderpath in $(find $targetdir -type d); do
	echo "--------------------------------------------------------------------"
	echo "Searching folder: $folderpath"
	echo "--------------------------------------------------------------------"
	echo ""
	cd $folderpath
	for myfile in *;
		do
		if [ -f "$myfile" ]; then
			locatedtext=$(grep -ni -w $targetgrep "$myfile")
			currentdirtemp=$(pwd)
			if [ ! -z "$locatedtext" ];then
				echo "******************Jackpot********************" | tee -a "$currentdir/NEOsearchKEYWORDS.txt"
				echo "" | tee -a "$currentdir/NEOsearchKEYWORDS.txt"
				echo "$currentdirtemp""/""$myfile" | tee -a "$currentdir/NEOsearchKEYWORDS.txt"
				echo "$locatedtext" | tee -a "$currentdir/NEOsearchKEYWORDS.txt"
				echo "" | tee -a "$currentdir/NEOsearchKEYWORDS.txt"
			fi
		fi
	done
done



